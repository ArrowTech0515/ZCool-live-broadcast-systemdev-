<template>
  <a-card>
    <template #title>
      <div style="display: flex; align-items: center; white-space: nowrap;">
        <a-button
          type="link"
          style="font-size: 18px; margin-right: 8px;"
          @click="handleBack"
        >
          <span style="font-size: 20px; font-weight: bold; margin-left: 8px;">&lt;</span>
        </a-button>
        <div style="flex-grow: 1; text-align: center;">
          <div v-if="operationType === 'æ·»åŠ '">
            <span style="font-size: 20px; font-weight: bold;">æ·»åŠ ä»»åŠ¡</span>
          </div>
          <div v-else>
            <span style="font-size: 20px; font-weight: bold;">ç¼–è¾‘ä»»åŠ¡</span>
          </div>
        </div>
      </div>
    </template>

    <div style="display: flex; justify-content: center;">
      <a-col layout="vertical" style="width: 100%; max-width: 800px; white-space: nowrap;">

        <!-- Form Items Here -->
        <div style="display: flex; align-items: center; width: 100%; margin-bottom: 20px;">
          <div style="flex: 1; font-weight: bold; text-align: right; padding-right: 10px; margin-right: 15px;">
            ä»»åŠ¡åç§°
          </div>
          <div style="width: 75%;">
            <div v-if="operationType === 'æ·»åŠ '">
              <a-input 
                placeholder="è¯·è¾“å…¥" 
                style="text-align: center; width: 75%;"
              />
            </div>
            <div v-else>
              <a-select v-model="taskList" value="all" style="width: 75%;">
                <a-select-option value="all">è¯·é€‰æ‹©ä»»åŠ¡</a-select-option>
                <a-select-option value="bindPhone">ç»‘å®šæ‰‹æœºå·</a-select-option>
                <a-select-option value="bindEmail">ç»‘å®šé‚®ç®±å·</a-select-option>
                <a-select-option value="setAccountPassword">è®¾ç½®è´¦å·å¯†ç </a-select-option>
                <a-select-option value="loginApp">ç™»å½•APP</a-select-option>
                <a-select-option value="shareLiveRoom">åˆ†äº«ä¸€æ¬¡ç›´æ’­é—´</a-select-option>
                <a-select-option value="watch10LiveRooms">è§‚çœ‹10ä¸ªç›´æ’­é—´</a-select-option>
                <a-select-option value="watch30LiveRooms">è§‚çœ‹30ä¸ªç›´æ’­é—´</a-select-option>
                <a-select-option value="watch10Minutes">è§‚çœ‹ç›´æ’­10åˆ†é’Ÿ</a-select-option>
                <a-select-option value="watch30Minutes">è§‚çœ‹ç›´æ’­30åˆ†é’Ÿ</a-select-option>
                <a-select-option value="watch2Hours">è§‚çœ‹ç›´æ’­2å°æ—¶</a-select-option>
                <a-select-option value="send5Barrage">ç›´æ’­é—´å¼¹å¹•å‘è¨€5æ¬¡</a-select-option>
                <a-select-option value="buyNoble">è´­ä¹°è´µæ—</a-select-option>
                <a-select-option value="firstRecharge">é¦–æ¬¡å……å€¼</a-select-option>
                <a-select-option value="recharge100Yuan">å……å€¼100å…ƒ</a-select-option>
                <a-select-option value="recharge1000Yuan">å……å€¼1000å…ƒ</a-select-option>
                <a-select-option value="postBarrage">å‘å¸ƒ1æ¡å¼¹å¹•</a-select-option>
                <a-select-option value="exchangeDiamonds">å…‘æ¢é’»çŸ³</a-select-option>
                <a-select-option value="firstSpendDiamonds">é¦–æ¬¡æ¶ˆè´¹é’»çŸ³</a-select-option>
                <a-select-option value="spend10000Diamonds">æ¶ˆè´¹é’»çŸ³10000é’»çŸ³</a-select-option>
                <a-select-option value="followStreamer">å…³æ³¨ä¸»æ’­</a-select-option>
                <a-select-option value="joinStreamerFanClub">åŠ å…¥ä»»æ„ä¸»æ’­ç²‰ä¸å›¢</a-select-option>
              </a-select>
            </div>
          </div>
        </div>

        <div style="display: flex; align-items: center; text-align: justify; width: 100%; margin-bottom: 15px;">
          <div style="flex: 1; font-weight: bold; text-align: right; padding-right: 10px;margin-right: 15px;">
            å¾ªç¯æœºåˆ¶
          </div>
          <div style="width: 75%;">
            <a-row type="flex" align="middle" justify="space-between" style="width: 75%; white-space: nowrap;">
              <!-- Radio Group on the left -->
              <a-col :span="16">
                <a-radio-group v-model="radioValueCycle" style="text-align: left;">
                  <a-radio value="radio1" style="margin-right: 75px;">æ¯æ—¥å¾ªç¯ä»»åŠ¡</a-radio>
                  <a-radio value="radio2">ä¸€æ¬¡æ€§ä»»åŠ¡</a-radio>
                </a-radio-group>
              </a-col>
            </a-row>
          </div>
        </div>

        <div style="display: flex; align-items: center; text-align: justify; width: 100%; margin-bottom: 15px;">
          <div style="flex: 1; font-weight: bold; text-align: right; padding-right: 10px;margin-right: 15px;">
            å‚ä¸ç”¨æˆ·
          </div>
          <div style="width: 75%;">
            <a-row type="flex" align="middle" justify="space-between" style="width: 75%; white-space: nowrap;">
              <!-- Radio Group on the left -->
              <a-col :span="16">
                <a-radio-group v-model="radioValueUserType" style="text-align: left;">
                  <a-radio value="radio1">å…¨éƒ¨ç”¨æˆ·</a-radio>
                  <a-radio value="radio2">è´µæ—ç”¨æˆ·</a-radio>
                  <a-radio value="radio3">æ–°æ³¨å†Œç”¨æˆ·</a-radio>
                  <a-radio value="radio5">è‡ªå®šä¹‰ç”¨æˆ·</a-radio>
                </a-radio-group>
                <a-button type="primary" ghost style=" padding: 0%; width: 100px; text-align: center;">+ é€‰æ‹©ç”¨æˆ·</a-button>
              </a-col>
            </a-row>
          </div>
        </div>

        <div style="display: flex; align-items: flex-start; width: 100%; margin-bottom: 15px; white-space: nowrap;">
          <div style="flex: 1; font-weight: bold; text-align: right; padding-right: 10px;margin-right: 15px;margin-top: 10px;">
            ä»»åŠ¡å¥–åŠ±
          </div>
          <div :flex="auto" style="width: 75%;">
            <a-row style="margin-bottom: 10px;">
              <a-radio-group
                  v-model="radioValueTaskType"
                  style="display: flex; align-items: center; justify-content: space-between;  width: 70%;">
                <a-radio value="radio1" style="margin-right: 10px;">é’»çŸ³å¥–åŠ±</a-radio>
                <a-radio value="radio2" style="margin-right: 10px;">ç¤¼ç‰©å¥–åŠ±</a-radio>
                <!-- Conditionally displayed button -->
                <div v-if="operationType === 'ç¼–è¾‘'" style="margin-right: 10px;">
                    <a-button @click="onSelectGift">é€‰æ‹©ç¤¼ç‰©</a-button>
                </div>
                <a-radio value="radio3">ä½™é¢å¥–åŠ±</a-radio>
              </a-radio-group>
            </a-row>

            <div v-if="operationType === 'ç¼–è¾‘'">
              <a-row gutter="[16, 16]" style="width: 100%; ">
                <a-col
                  v-for="(spinPair, index) in spinCards"
                  :key="index"
                  :span="5" 
                  style="margin-bottom: 5px; display: flex; justify-content: center;">
                  
                  <GiftPanel 
                    :spinValue="spinPair.spinValue" 
                    :curIndex="spinPair.curIndex" 
                    :name="spinPair.name"
                    :icon="spinPair.icon"
                    @remove-custom-spin="removeCustomSpin"/>
                </a-col>
              </a-row>
            </div>
            <div v-else>
              <CustomSpin v-model:nValue="spin_value1" style="width: 60%; margin-bottom: 5px;"></CustomSpin>
            </div>
          </div>
        </div>

        <div style="display: flex; align-items: center; width: 100%; margin-bottom: 20px;">
          <div style="flex: 1; font-weight: bold; text-align: right; padding-right: 10px;margin-right: 15px;">
            ä»»åŠ¡æ¬¡æ•°
          </div>
          <div style="width: 75%;">
            <a-row >
              <CustomSpin v-model:nValue="spin_value1" style="width: 60%;"></CustomSpin>
            </a-row>
          </div>
        </div>

        <div style="display: flex; align-items: center; width: 100%; margin-bottom: 20px;">
          <div style="flex: 1; font-weight: bold; text-align: right; padding-right: 10px;margin-right: 15px;">
            æ´»åŠ¨æ—¶é—´
          </div>
          <a-row type="flex" style="width: 75%;" align="middle">
            <a-col :span="10">
              <a-radio-group v-model="radioValueActivityTime">
                <a-radio value="radio1">æ°¸ä¹…æœ‰æ•ˆ</a-radio>
                <a-radio value="radio2">è‡ªå®šä¹‰æ—¶é—´</a-radio>
              </a-radio-group>
            </a-col>
            <a-col :span="8">
              <a-range-picker 
                :placeholder="['å¼€å§‹æ—¥æœŸ', 'ç»“æŸæ—¥æœŸ']"
              />
            </a-col>
          </a-row>
        </div>

        <!-- Center Aligned Save Button -->
        <a-form-item style="text-align: center; margin: 30px; white-space: nowrap;">
          <a-button style="width: 120px; margin-right: 30px;" @click="handleCancel">å–æ¶ˆ</a-button>
          <a-button style="width: 120px;" type="primary" @click="handleSave">ç¡®å®š</a-button>
        </a-form-item>

      </a-col>
    </div>

  </a-card>
  
  <SelectGiftDialog 
        :isModalVisible="isModalVisible"
      @update:is-modal-visible="val => isModalVisible = val" />

</template>

<script>
import CustomSpin from '@/components/Form/Custom/CustomSpin.vue'
// const uploadRule = createUploadRule('ä¸»æ’­å¤´åƒ', 'avatar_url')
import GiftPanel from './GiftPanel.vue'
import SelectGiftDialog from './selectGiftDialog.vue'


export default {
  components: {
    CustomSpin,
    GiftPanel,
    SelectGiftDialog
  },
  props: {
    operationType: {
      type: String,
      default: 'æ–°å¢',
    },
  },
  data() {
    return {
      isModalVisible : false,

      radioValueTaskType: 'radio1',  // For Task Type Radio Group
      radioValueCycle: 'radio1',     // For Cycle Mechanism Radio Group
      radioValueUserType: 'radio1',  // For Participant User Type Radio Group
      radioValueActivityTime: 'radio1',  // For Activity Time Radio Group

      parentValue: '0', // Example initial value

      spin_value1: '0',

      spinCards: [
      { curIndex: 0, name: 'ç¤¼ç‰©', icon: 'ğŸ', spinValue: 0 },
      { curIndex: 1, name: 'ç¤¼ç‰©', icon: 'ğŸ‚', spinValue: 20 },
      { curIndex: 2, name: 'ç¤¼ç‰©', icon: 'ğŸ«', spinValue: 15 },
      // { id: 4, name: 'Gift 4', icon: 'ğŸ’', spinValue: 50 },
      // { id: 5, name: 'Gift 5', icon: 'ğŸ§¸', spinValue: 25 },
      // { id: 6, name: 'Gift 6', icon: 'ğŸ®', spinValue: 30 },
      // { id: 7, name: 'Gift 7', icon: 'ğŸ†', spinValue: 40 },
      // { id: 8, name: 'Gift 8', icon: 'ğŸ“±', spinValue: 35 }
    ],
      giftValidity: ''
    };
  },

  computed: {

  },

  methods: {
    addCustomSpin() {
      const newId = this.spinCards.length
      this.spinCards.push({
        curIndex: newId,
        name: `Gift ${newId}`,
        icon: 'ğŸ', // Default icon or change as needed
        spinValue: 0 // Default value, can be modified
      })
    },
    removeCustomSpin(curIndex) {
      console.log("removeCustomSpin : " + curIndex)
      console.log("removeCustomSpin1 : " + this.spinCards[curIndex].spinValue)
      console.log("removeCustomSpin2 : " + this.spinCards[curIndex].curIndex)
      this.spinCards.splice(curIndex, 1)
      //this.spinCards = this.spinCards.filter(spinPair => spinPair.id !== id);
    },

    handleSave() {
    //  emit('save', props.formData)
      this.handleBack()
    },

    handleCancel() {
    //  updateVisible(false)
      this.handleBack()
    },

    handleBack() {
      // Handle the back action here
      // For example, navigate to the previous page:
      this.$emit('back'); // Emit the back event to the parent component
    },
    handleOperation(text) {
      // Handle the operation related to "åŒºå—é“¾æ±‡ç‡"
      console.log(text);
    },
    handleAllusers() {
      // Handle All users selection
    },
    handleNobleusers() {
      // Handle Noble users selection
    },
    handleRechargeusers() {
      // Handle Recharge users selection
    },
    handleCustomusers() {
      // Handle Custom users selection
    },
    onSelectGift() {
      //this.editItem()
      console.log("handleOperation : " + this.isModalVisible.value)
      this.isModalVisible  = true
    }
  },
};
</script>

<style scoped>
</style>
